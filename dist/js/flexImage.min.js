/*
 * flexImage.js 1.0.0
 * https://github.com/YuTingtao/flexImage.js
 * description: 轻量级横向瀑布流插件，无依赖，兼容IE9以上，类似百度图片、谷歌图片展示效果
 * author: 735126858@qq.com
 * license: MIT
 */
!function(t,e){"function"==typeof define&&define.amd?define(e):"undefined"!=typeof exports?module.exports=e():t.FlexImage=e()}(this,function(){var n={rowHeight:200,listenResize:!1,item:".fleximage-item",itemObject:"img"};function t(t,e){var i=this;this.el=t,this.opt=this.extend(n,e),this.lastRows=[],this.itemLength=0,setTimeout(function(){i.init()},50)}return t.prototype={constructor:t,extend:function(t,e){for(var i in t)t.hasOwnProperty(i)&&!e.hasOwnProperty(i)&&(e[i]=t[i]);return e},getStyle:function(t){return window.getComputedStyle?getComputedStyle(t,null):t.currentStyle},getMbWidth:function(t){t=this.getStyle(t);return(parseInt(t.marginLeft)||0)+(parseInt(t.marginRight)||0)+(Math.round(parseFloat(t.borderLeftWidth))||0)+(Math.round(parseFloat(t.borderRightWidth))||0)},setLayout:function(t,e,i,n){for(var r=parseInt(this.getStyle(t).width),s=[],h=0,o=(i.rowHeight,0),a=0,u=0;u<e.length;u++){var l=e[u],d=l.querySelector(i.itemObject);if(itemDataW=parseInt(l.getAttribute("data-w")),itemWidth=itemDataW*(i.rowHeight/parseInt(l.getAttribute("data-h"))),l.style.float="left",l.style.width=itemWidth+"px",l.style.height=i.rowHeight+"px",d.style.width="100%",d.style.height="100%",s.push(l),o+=this.getMbWidth(l),h+=itemWidth+this.getMbWidth(l),u==e.length-1&&n(s),r<=h){for(var g=0,f=(r-o)/(h-o),m=Math.round(i.rowHeight*f),p=0;p<s.length;p++)(r<(g+=(a=Math.round(parseInt(s[p].style.width)*f))+this.getMbWidth(s[p]))||g+s.length>r)&&(a-=g-r),s[p].style.width=a+"px",s[p].style.height=m+"px";s=[],h=o=0}}},init:function(){var e=this,t=this.el,i=this.opt,n=t.querySelectorAll(i.item);function r(t){e.lastRows=t}return this.itemLength=n.length,e.setLayout(t,n,i,r),i.listenResize&&window.addEventListener("resize",function(){setTimeout(function(){e.setLayout(t,n,i,r),0},300)}),e},update:function(){var e=this,t=this.el,i=this.opt,n=t.querySelectorAll(i.item);if(n&&n.length>this.itemLength){for(var r=this.lastRows,s=this.itemLength;s<n.length;s++)r.push(n[s]);function h(t){e.lastRows=t}function o(){setTimeout(function(){e.setLayout(t,n,i,h),0},300)}this.itemLength=n.length,e.setLayout(t,r,i,h),i.listenResize&&(window.removeEventListener("resize",o),window.addEventListener("resize",o))}return e}},t});
/*
 * flexImage.js 1.0.0
 * https://github.com/YuTingtao/flexImage.js
 * description: 轻量级横向瀑布流插件，无依赖，兼容IE9以上，类似百度图片、谷歌图片展示效果
 * author: 735126858@qq.com
 * license: MIT
 */
!function(t,e){"function"==typeof define&&define.amd?define(e):"undefined"!=typeof exports?module.exports=e():t.FlexImage=e()}(this,function(){var h={rowHeight:200,listenResize:!1,item:".fleximage-item",itemObject:"img"};function t(t,e){var i=this;this.el=t,this.opt=this.extend(h,e),this.lastRows=[],this.itemLength=0,this.init(),this.opt.listenResize&&window.addEventListener("resize",function(){i.setLayout()})}return t.prototype={constructor:t,extend:function(t,e){for(var i in t)t.hasOwnProperty(i)&&!e.hasOwnProperty(i)&&(e[i]=t[i]);return e},getStyle:function(t){return window.getComputedStyle?getComputedStyle(t,null):t.currentStyle},getMbWidth:function(t){t=this.getStyle(t);return(parseInt(t.marginLeft)||0)+(parseInt(t.marginRight)||0)+(Math.round(parseFloat(t.borderLeftWidth))||0)+(Math.round(parseFloat(t.borderRightWidth))||0)},setLayout:function(t){var e=parseInt(this.getStyle(this.el).width),i=this.opt,t=t||this.el.querySelectorAll(i.item);rows=[],rowWidth=0,rowHeight=i.rowHeight,rowMbWidth=0,showWidth=0,ratio=1;for(var h=0;h<t.length;h++){var r=t[h],o=r.querySelector(i.itemObject);if(itemDataW=parseInt(r.getAttribute("data-w")),itemWidth=itemDataW*(i.rowHeight/parseInt(r.getAttribute("data-h"))),r.style.float="left",r.style.width=itemWidth+"px",r.style.height=i.rowHeight+"px",o.style.width="100%",o.style.height="100%",rows.push(r),rowMbWidth+=this.getMbWidth(r),rowWidth+=itemWidth+this.getMbWidth(r),h==t.length-1&&(this.lastRows=rows),rowWidth>=e){var s=0;ratio=(e-rowMbWidth)/(rowWidth-rowMbWidth),rowHeight=Math.round(i.rowHeight*ratio);for(var n=0;n<rows.length;n++)showWidth=Math.round(parseInt(rows[n].style.width)*ratio),(e<(s+=showWidth+this.getMbWidth(rows[n]))||s+rows.length>e)&&(showWidth-=s-e),rows[n].style.width=showWidth+"px",rows[n].style.height=rowHeight+"px";rows=[],rowMbWidth=0,rowWidth=0}}},init:function(){var t=this.el,e=this.opt,e=t.querySelectorAll(e.item);return this.itemLength=e.length,this.setLayout(),this},update:function(){var t=this.el,e=this.opt,i=t.querySelectorAll(e.item);if(i&&i.length>this.itemLength){for(var h=this.lastRows,r=this.itemLength;r<i.length;r++)h.push(i[r]);this.itemLength=i.length,this.setLayout(h)}return this}},t});
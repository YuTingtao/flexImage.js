/*
 * flexImage.js 1.0.0
 * https://github.com/YuTingtao/flexImage.js
 * description: 轻量级横向瀑布流插件，无依赖，兼容IE9以上，类似百度图片、谷歌图片展示效果
 * author: 735126858@qq.com
 * license: MIT
 */
!function(t,e){"function"==typeof define&&define.amd?define(e):"undefined"!=typeof exports?module.exports=e():t.FlexImage=e()}(this,function(){var n={rowHeight:200,listenResize:!1,item:".fleximage-item",itemObject:"img"};function t(t,e){var i=this;this.el=t,this.opt=this.extend(n,e),this.lastRows=[],this.itemLength=0,setTimeout(function(){i.init()},50)}return t.prototype={constructor:t,extend:function(t,e){for(var i in t)t.hasOwnProperty(i)&&!e.hasOwnProperty(i)&&(e[i]=t[i]);return e},getStyle:function(t){return window.getComputedStyle?getComputedStyle(t,null):t.currentStyle},getMbWidth:function(t){t=this.getStyle(t);return(parseInt(t.marginLeft)||0)+(parseInt(t.marginRight)||0)+(Math.round(parseFloat(t.borderLeftWidth))||0)+(Math.round(parseFloat(t.borderRightWidth))||0)},setLayout:function(t,e,i,n){for(var r=parseInt(this.getStyle(t).width),h=[],s=0,o=(i.rowHeight,0),a=0,l=0;l<e.length;l++){var u=e[l],d=u.querySelector(i.itemObject);if(itemDataW=parseInt(u.getAttribute("data-w")),itemWidth=itemDataW*(i.rowHeight/parseInt(u.getAttribute("data-h"))),u.style.float="left",u.style.width=itemWidth+"px",u.style.height=i.rowHeight+"px",d.style.width="100%",d.style.height="100%",h.push(u),o+=this.getMbWidth(u),s+=itemWidth+this.getMbWidth(u),l==e.length-1&&n(h),r<=s){for(var g=0,f=(r-o)/(s-o),p=Math.round(i.rowHeight*f),m=0;m<h.length;m++)(r<(g+=(a=Math.round(parseInt(h[m].style.width)*f))+this.getMbWidth(h[m]))||g+h.length>r)&&(a-=g-r),h[m].style.width=a+"px",h[m].style.height=p+"px";h=[],s=o=0}}},init:function(){var e=this,t=this.el,i=this.opt,n=t.querySelectorAll(i.item);function r(t){e.lastRows=t}return this.itemLength=n.length,e.setLayout(t,n,i,r),i.listenResize&&window.addEventListener("resize",function(){e.setLayout(t,n,i,r)}),e},update:function(){var e=this,t=this.el,i=this.opt,n=t.querySelectorAll(i.item);if(n&&n.length>this.itemLength){for(var r=this.lastRows,h=this.itemLength;h<n.length;h++)r.push(n[h]);function s(t){e.lastRows=t}function o(){e.setLayout(t,n,i,s)}this.itemLength=n.length,e.setLayout(t,r,i,s),i.listenResize&&(window.removeEventListener("resize",o),window.addEventListener("resize",o))}return e}},t});
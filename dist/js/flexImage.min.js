/*
 * flexImage.js 1.0.0
 * https://github.com/YuTingtao/flexImage.js
 * description: 轻量级横向瀑布流插件，无依赖，兼容IE9以上，类似百度图片、谷歌图片展示效果
 * author: 735126858@qq.com
 * license: MIT
 */
!function(t,e){"function"==typeof define&&define.amd?define(e):"undefined"!=typeof exports?module.exports=e():t.FlexImage=e()}(this,function(){var r={rowHeight:200,listenResize:!1,item:".fleximage-item",itemObject:"img"};function t(t,e){var i=this;this.el=t,this.opt=this.extend(r,e),this.lastRows=[],this.itemLength=0,this.init(),this.opt.listenResize&&window.addEventListener("resize",function(){i.setLayout()})}return t.prototype={constructor:t,extend:function(t,e){for(var i in t)t.hasOwnProperty(i)&&!e.hasOwnProperty(i)&&(e[i]=t[i]);return e},getStyle:function(t){return window.getComputedStyle?getComputedStyle(t,null):t.currentStyle},getMbWidth:function(t){t=this.getStyle(t);return(parseInt(t.marginLeft)||0)+(parseInt(t.marginRight)||0)+(Math.round(parseFloat(t.borderLeftWidth))||0)+(Math.round(parseFloat(t.borderRightWidth))||0)},setLayout:function(t){var e=parseInt(this.getStyle(this.el).width),i=this.opt,t=t||this.el.querySelectorAll(i.item);rows=[],rowWidth=0,rowHeight=i.rowHeight,rowMbWidth=0,newWidth=0,ratio=1;for(var r=0;r<t.length;r++){var h=t[r],o=h.querySelector(i.itemObject);if(itemDataW=parseInt(h.getAttribute("data-w")),itemWidth=itemDataW*(i.rowHeight/parseInt(h.getAttribute("data-h"))),h.style.float="left",h.style.width=itemWidth+"px",h.style.height=i.rowHeight+"px",o.style.width="100%",o.style.height="100%",rows.push(h),rowMbWidth+=this.getMbWidth(h),rowWidth+=itemWidth+this.getMbWidth(h),r==t.length-1&&(this.lastRows=rows),rowWidth>=e){var n=0;ratio=(e-rowMbWidth)/(rowWidth-rowMbWidth),rowHeight=Math.round(i.rowHeight*ratio);for(var s=0;s<rows.length;s++)newWidth=Math.round(parseInt(rows[s].style.width)*ratio),(e<(n+=newWidth+this.getMbWidth(rows[s]))||n+rows.length>e)&&(newWidth-=n-e),rows[s].style.width=newWidth+"px",rows[s].style.height=rowHeight+"px";=0,rowWidth=0}}},init:function(){var t=this,e=this.el,i=this.opt,i=e.querySelectorAll(i.item);return this.itemLength=i.length,setTimeout(function(){t.setLayout()},0),t},update:function(){var t=this.el,e=this.opt,i=t.querySelectorAll(e.item);if(i&&i.length>this.itemLength){for(var r=this.lastRows,h=this.itemLength;h<i.length;h++)r.push(i[h]);this.itemLength=i.length,this.setLayout(r)}return this}},t});
